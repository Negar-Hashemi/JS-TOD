
**JS-TOD**

JS-TOD (**J**ava**S**cript - **T**est **O**rder-dependency **D**etector) is a tool to extract and detect order-dependent tests in Jest. JS-TOD is designed to reorder and rerun test suites, describe blocks, and individual test cases in JavaScript projects. By automatically shuffling test execution order and running multiple iterations, JS-TOD helps you detect hidden dependencies between tests and improve the robustness of your test suite.

The tool contains the following scripts: 

1. `testReorderRunner.js`: reorders tests inside `describe` blocks of a given project for a defined number (`reorder`) and saves the results in the `___extracted results___` folder inside the project folder. It will then run all the new test suites for `rerun` number and save the results as a JSON file in the same folder. The results are named starting with the term testOutput, followed by the name of the test suite and the rerun count.

2. `testOutputParser.js`: parses the JSON files located in the `___extracted results___` folder of a given project, generated after running `testReorderRunner.js`. It summarizes the results, including the name of the test suite, along with the number of failing and passing tests, in a CSV file. Each CSV file is named after the corresponding test suite followed by the term output. These CSV files are stored in the `output parsing` folder within the `___extracted results___` directory.

3. `describeReorderRunner.js`: reorders describe blocks of a given project for a defined number (`reorder`) and save the results in the `___extracted results describes___` folder inside the project folder. It will then run all new test suites for `rerun` number and save the results as a JSON file in the same folder. The results are named starting with the term testOutput, followed by the name of the test suite and the rerun count.

4. `describeOutputParser.js`: parses the JSON files located in the `___extracted results describes___` folder of a given project, generated after running `describeReorderRunner.js`. It summarizes the results, including the name of the test suite, along with the number of failing and passing tests, in a CSV file. Each CSV file is named after the corresponding test suite followed by the term output. These CSV files are stored in the `output parsing` folder within the `___extracted results describes___` directory.

5. `testSuitesReorderRunner.js`: reorders the test suites of a given project for a defined number (`reorder`), runs them for `rerun` number, and saves the results in the `___extracted results test files___` folder inside the project folder. The results are named starting with the term testOutput, followed by the number of reordering and rerun counts.

6. `testSuitesOutputParser.js`: parses the JSON files located in the `___extracted results test files___` folder of a given project, generated after running `testSuitesReorderRunner.js`. It summarizes the results, including the number of order, along with the number of failing and passing tests, in a CSV file. Each CSV file is named `order` and order number followed by the term output. These CSV files are stored in the `output parsing` folder within the `___extracted results test files___` directory.

7. `reorderRunner.js`: Runs the reordering process at all three levels—test suites, describe blocks, and individual tests—for a given project.

8. `customSequencer.js` is the custom sequencer extended from Jest's `testSequencer`. It is used by `testSuitesReorderRunner.js`.


## Dependencies

This project relies on the following dependencies:

### Required modules
- [**Node.js**](https://nodejs.org/en) 
- [**Jest**](https://jestjs.io/)
- [**npm**](https://docs.npmjs.com/cli/v10/commands/npm-install)
- [**npx**](https://docs.npmjs.com/cli/v10/commands/npx)
- [**babel**](https://babeljs.io/docs/babel-parser)

Specifically, JS-TOD requires the following utilities: 

- **@babel/parser**: A JavaScript parser.
- **@babel/traverse**: A utility for traversing and manipulating abstract syntax trees (ASTs) generated by Babel.
- **@babel/generator**: A utility for generating code from ASTs produced by Babel.
- **is-utf8**: A utility to check if a buffer contains UTF-8 encoded text.

### Installation

Before running the scripts, you need to install the necessary dependencies. You can do this by running the following command:

```bash 
npm install
```
## Reordering and Running tests using *JS-TOD*

1. Change the directory to where JS-TOD is located:

```bash
cd /path/to/directory_containing_JS-TOD

```
2. Choose the level of reordering(tests, describe blocks or test suites). For example for reordering and running in all levels for a given project:

```bash
node reorderRunner.js --project_path="/path/to/project" --rerun=<value> --reorder=<value>
 
```

- `project_path` sets the path of the project.

- `rerun` sets the number of rerunning. The default number of reruns is 10.

- `reorder` sets the number of reordering. The default number of reorders is 10.

